<!doctype html>
<html>
<head><meta charset="utf-8"><title>KPIs</title></head>
<body>
<button id="load">Load KPIs</button>
<pre id="out">Click "Load KPIs"</pre>
<script>
document.getElementById('load').addEventListener('click', async () => {
const out = document.getElementById('out');
out.textContent = "Loading...";
try {
const res = await fetch('/.netlify/functions/proxy-kpi');
const { kpis = {}, diag = {} } = await res.json();
const lines = [
"paidVsBudget (raw): " + (kpis.paidVsBudget ?? 0),
"paidVsBudget (%): " + ((kpis.paidVsBudget ?? 0) * 100).toFixed(2) + "%",
"deliverablesProgress (raw): " + (kpis.deliverablesProgress ?? 0),
"deliverablesProgress (%): " + ((kpis.deliverablesProgress ?? 0) * 100).toFixed(0) + "%",
"overBudgetCount: " + (kpis.overBudgetCount ?? 0),
"daysToLaunch: " + (kpis.daysToLaunch ?? 0),
"",
"diag.milestonesCount: " + (diag.milestonesCount ?? 0),
"diag.paidVsBudget_usedRows: " + (diag.paidVsBudget_usedRows ?? 0),
"diag.deliverables_usedRows: " + (diag.deliverables_usedRows ?? 0),
"diag.hasLaunchDate: " + (!!diag.hasLaunchDate)
];
out.textContent = lines.join("n");
} catch (e) {
out.textContent = "Error: " + e.message;
}
});
</script>
</body>
</html>
